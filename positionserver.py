#!/home/n0ak95/anaconda3/envs/amitalice/bin/python

import os
import threading
from flask import json
from flask import Flask, request, redirect
from flask_cors import CORS, cross_origin

# creating instance of Flask
app = Flask(__name__)
cors = CORS(app, resources={r"/foo": {"origins": "*"}})
CORS(app, support_credentials=True)
# app.config['CORS_HEADERS'] = 'Content-Type'


positions_data = {'NetMTM': {'netmtm': 1174.3,
  'series': [{'data': [100.0,
     7200.0,
     -950.0,
     -5022.5,
     18790.0,
     56.25,
     -3808.75,
     4395.0,
     1770.0,
     -9857.5,
     3240.0,
     15496.25,
     -5020.0,
     -3611.25,
     2800.0,
     3538.75,
     1628.75,
     -6266.25,
     -463.75,
     -11476.25,
     -9926.25,
     -8442.5,
     -4863.75,
     4636.25,
     -9605.0,
     8397.5,
     1427.5,
     2013.75,
     945.0,
     -1076.25,
     -637.5,
     930.0,
     -100.0,
     1666.8,
     3570.0,
     -300.0],
    'name': 'MTM'}]},
 'NetPNL': {'netpnl': -4928.2,
  'series': [{'data': [79.9999999999983,
     -100.0,
     -950.0,
     -5061.5,
     18654.0,
     56.250000000000355,
     -3808.75,
     4395.999999999999,
     1771.25,
     -9857.25,
     3240.0000000000005,
     15495.999999999998,
     -5022.0,
     -3611.9999999999995,
     2800.0,
     3538.0,
     1628.0,
     -6266.0,
     -464.0,
     -11475.75,
     -9926.25,
     -8443.5,
     -4863.75,
     4635.999999999998,
     -8156.0,
     8397.0,
     1342.0,
     2014.0,
     946.0,
     -1075.9999999999998,
     -637.5,
     930.7500000000001,
     -100.00000000002274,
     1666.8,
     3570.0,
     -270.0000000000009],
    'name': 'PNL'}]},
 'congratulations': {'name': 'Kavita Ghosh', 'openpositionscount': 14},
 'position': {'positiongrp': [],
  'positions': [{'average': 27.04,
    'broker': 'AliceBlue',
    'client_id': 'SP22046',
    'id': 0,
    'ltp': 27.0,
    'm2m': 100.0,
    'net_quantity': -2000,
    'pnl': 79.9999999999983,
    'trading_symbol': 'ADANIENT21APR1200CE'},
   {'average': 0.0,
    'broker': 'AliceBlue',
    'client_id': 'SP22046',
    'id': 1,
    'ltp': 7.25,
    'm2m': 7200.0,
    'net_quantity': 0,
    'pnl': -100.0,
    'trading_symbol': 'ADANIENT21APR900PE'},
   {'average': 0.0,
    'broker': 'AliceBlue',
    'client_id': 'SP22046',
    'id': 2,
    'ltp': 14.85,
    'm2m': -950.0,
    'net_quantity': 0,
    'pnl': -950.0,
    'trading_symbol': 'BANKNIFTY2141529000PE'},
   {'average': 0.0,
    'broker': 'AliceBlue',
    'client_id': 'SP22046',
    'id': 3,
    'ltp': 21.15,
    'm2m': -5022.5,
    'net_quantity': 0,
    'pnl': -5061.5,
    'trading_symbol': 'BANKNIFTY2141529500PE'},
   {'average': 0.0,
    'broker': 'AliceBlue',
    'client_id': 'SP22046',
    'id': 4,
    'ltp': 25.75,
    'm2m': 18790.0,
    'net_quantity': 0,
    'pnl': 18654.0,
    'trading_symbol': 'BANKNIFTY2141529700PE'},
   {'average': 34.45,
    'broker': 'AliceBlue',
    'client_id': 'SP22046',
    'id': 5,
    'ltp': 34.0,
    'm2m': 56.25,
    'net_quantity': -125,
    'pnl': 56.250000000000355,
    'trading_symbol': 'BANKNIFTY2141530000PE'},
   {'average': 0.0,
    'broker': 'AliceBlue',
    'client_id': 'SP22046',
    'id': 6,
    'ltp': 38.0,
    'm2m': -3808.75,
    'net_quantity': 0,
    'pnl': -3808.75,
    'trading_symbol': 'BANKNIFTY2141530100PE'},
   {'average': 31.01,
    'broker': 'AliceBlue',
    'client_id': 'SP22046',
    'id': 7,
    'ltp': 42.0,
    'm2m': 4395.0,
    'net_quantity': 400,
    'pnl': 4395.999999999999,
    'trading_symbol': 'BANKNIFTY2141530200PE'},
   {'average': 0.0,
    'broker': 'AliceBlue',
    'client_id': 'SP22046',
    'id': 8,
    'ltp': 47.0,
    'm2m': 1770.0,
    'net_quantity': 0,
    'pnl': 1771.25,
    'trading_symbol': 'BANKNIFTY2141530300PE'},
   {'average': 0.0,
    'broker': 'AliceBlue',
    'client_id': 'SP22046',
    'id': 9,
    'ltp': 52.0,
    'm2m': -9857.5,
    'net_quantity': 0,
    'pnl': -9857.25,
    'trading_symbol': 'BANKNIFTY2141530400PE'},
   {'average': 41.0,
    'broker': 'AliceBlue',
    'client_id': 'SP22046',
    'id': 10,
    'ltp': 57.2,
    'm2m': 3240.0,
    'net_quantity': 200,
    'pnl': 3240.0000000000005,
    'trading_symbol': 'BANKNIFTY2141530500PE'},
   {'average': 134.63,
    'broker': 'AliceBlue',
    'client_id': 'SP22046',
    'id': 11,
    'ltp': 57.15,
    'm2m': 15496.25,
    'net_quantity': -200,
    'pnl': 15495.999999999998,
    'trading_symbol': 'BANKNIFTY2141530600PE'},
   {'average': 40.89,
    'broker': 'AliceBlue',
    'client_id': 'SP22046',
    'id': 12,
    'ltp': 66.0,
    'm2m': -5020.0,
    'net_quantity': -200,
    'pnl': -5022.0,
    'trading_symbol': 'BANKNIFTY2141530700PE'},
   {'average': 34.48,
    'broker': 'AliceBlue',
    'client_id': 'SP22046',
    'id': 13,
    'ltp': 70.6,
    'm2m': -3611.25,
    'net_quantity': -100,
    'pnl': -3611.9999999999995,
    'trading_symbol': 'BANKNIFTY2141530800PE'},
   {'average': 0.0,
    'broker': 'AliceBlue',
    'client_id': 'SP22046',
    'id': 14,
    'ltp': 85.0,
    'm2m': 2800.0,
    'net_quantity': 0,
    'pnl': 2800.0,
    'trading_symbol': 'BANKNIFTY2141530900PE'},
   {'average': 0.0,
    'broker': 'AliceBlue',
    'client_id': 'SP22046',
    'id': 15,
    'ltp': 99.0,
    'm2m': 3538.75,
    'net_quantity': 0,
    'pnl': 3538.0,
    'trading_symbol': 'BANKNIFTY2141531000PE'},
   {'average': 0.0,
    'broker': 'AliceBlue',
    'client_id': 'SP22046',
    'id': 16,
    'ltp': 119.0,
    'm2m': 1628.75,
    'net_quantity': 0,
    'pnl': 1628.0,
    'trading_symbol': 'BANKNIFTY2141531100PE'},
   {'average': 121.67,
    'broker': 'AliceBlue',
    'client_id': 'SP22046',
    'id': 17,
    'ltp': 153.0,
    'm2m': -6266.25,
    'net_quantity': -200,
    'pnl': -6266.0,
    'trading_symbol': 'BANKNIFTY2141531300PE'},
   {'average': 0.0,
    'broker': 'AliceBlue',
    'client_id': 'SP22046',
    'id': 18,
    'ltp': 345.7,
    'm2m': -463.75,
    'net_quantity': 0,
    'pnl': -464.0,
    'trading_symbol': 'BANKNIFTY2141531600CE'},
   {'average': 0.0,
    'broker': 'AliceBlue',
    'client_id': 'SP22046',
    'id': 19,
    'ltp': 292.15,
    'm2m': -11476.25,
    'net_quantity': 0,
    'pnl': -11475.75,
    'trading_symbol': 'BANKNIFTY2141531700CE'},
   {'average': 0.0,
    'broker': 'AliceBlue',
    'client_id': 'SP22046',
    'id': 20,
    'ltp': 239.95,
    'm2m': -9926.25,
    'net_quantity': 0,
    'pnl': -9926.25,
    'trading_symbol': 'BANKNIFTY2141531800CE'},
   {'average': 0.0,
    'broker': 'AliceBlue',
    'client_id': 'SP22046',
    'id': 21,
    'ltp': 188.0,
    'm2m': -8442.5,
    'net_quantity': 0,
    'pnl': -8443.5,
    'trading_symbol': 'BANKNIFTY2141531900CE'},
   {'average': 0.0,
    'broker': 'AliceBlue',
    'client_id': 'SP22046',
    'id': 22,
    'ltp': 148.85,
    'm2m': -4863.75,
    'net_quantity': 0,
    'pnl': -4863.75,
    'trading_symbol': 'BANKNIFTY2141532000CE'},
   {'average': 128.23,
    'broker': 'AliceBlue',
    'client_id': 'SP22046',
    'id': 23,
    'ltp': 105.05,
    'm2m': 4636.25,
    'net_quantity': -200,
    'pnl': 4635.999999999998,
    'trading_symbol': 'BANKNIFTY2141532100CE'},
   {'average': 0.0,
    'broker': 'AliceBlue',
    'client_id': 'SP22046',
    'id': 24,
    'ltp': 73.0,
    'm2m': -9605.0,
    'net_quantity': 0,
    'pnl': -8156.0,
    'trading_symbol': 'BANKNIFTY2141532200CE'},
   {'average': 0.0,
    'broker': 'AliceBlue',
    'client_id': 'SP22046',
    'id': 25,
    'ltp': 52.05,
    'm2m': 8397.5,
    'net_quantity': 0,
    'pnl': 8397.0,
    'trading_symbol': 'BANKNIFTY2141532300CE'},
   {'average': 0.0,
    'broker': 'AliceBlue',
    'client_id': 'SP22046',
    'id': 26,
    'ltp': 43.05,
    'm2m': 1427.5,
    'net_quantity': 0,
    'pnl': 1342.0,
    'trading_symbol': 'BANKNIFTY2141532400CE'},
   {'average': 45.12,
    'broker': 'AliceBlue',
    'client_id': 'SP22046',
    'id': 27,
    'ltp': 35.05,
    'm2m': 2013.75,
    'net_quantity': -200,
    'pnl': 2014.0,
    'trading_symbol': 'BANKNIFTY2141532500CE'},
   {'average': 0.0,
    'broker': 'AliceBlue',
    'client_id': 'SP22046',
    'id': 28,
    'ltp': 28.0,
    'm2m': 945.0,
    'net_quantity': 0,
    'pnl': 946.0,
    'trading_symbol': 'BANKNIFTY2141532600CE'},
   {'average': 23.38,
    'broker': 'AliceBlue',
    'client_id': 'SP22046',
    'id': 29,
    'ltp': 18.0,
    'm2m': -1076.25,
    'net_quantity': 200,
    'pnl': -1075.9999999999998,
    'trading_symbol': 'BANKNIFTY2141532800CE'},
   {'average': 0.0,
    'broker': 'AliceBlue',
    'client_id': 'SP22046',
    'id': 30,
    'ltp': 9.2,
    'm2m': -637.5,
    'net_quantity': 0,
    'pnl': -637.5,
    'trading_symbol': 'NIFTY2141514000PE'},
   {'average': 24.76,
    'broker': 'AliceBlue',
    'client_id': 'SP22046',
    'id': 31,
    'ltp': 12.35,
    'm2m': 930.0,
    'net_quantity': -75,
    'pnl': 930.7500000000001,
    'trading_symbol': 'NIFTY2141514100PE'},
   {'average': 100.65,
    'broker': 'AliceBlue',
    'client_id': 'SP22046',
    'id': 32,
    'ltp': 100.6,
    'm2m': -100.0,
    'net_quantity': 2000,
    'pnl': -100.00000000002274,
    'trading_symbol': 'NTPC-EQ'},
   {'average': 0.0,
    'broker': 'AliceBlue',
    'client_id': 'SP22046',
    'id': 33,
    'ltp': 109.95,
    'm2m': 1666.8,
    'net_quantity': 0,
    'pnl': 1666.8,
    'trading_symbol': 'PFC-EQ'},
   {'average': 0.0,
    'broker': 'AliceBlue',
    'client_id': 'SP22046',
    'id': 34,
    'ltp': 6.35,
    'm2m': 3570.0,
    'net_quantity': 0,
    'pnl': 3570.0,
    'trading_symbol': 'SUNPHARMA21APR600PE'},
   {'average': 3.26,
    'broker': 'AliceBlue',
    'client_id': 'SP22046',
    'id': 35,
    'ltp': 3.35,
    'm2m': -300.0,
    'net_quantity': -3000,
    'pnl': -270.0000000000009,
    'trading_symbol': 'TORNTPOWER21APR430CE'}]}}

# @app.route('/positions/data')
# @cross_origin(origin='*',headers=['Content-Type','Authorization'])

@app.route('/positions/data')
@cross_origin(origin='*')
def get_authorization_url():
    response = app.response_class(
    response=json.dumps(positions_data),
    status=200,
    mimetype='application/json'
    )
    print('Positions Data > ')
    print(response)
    return response


# @app.route('/')
# def callback():
#     global access_token
#     oauth = OAuth2Session(client_id, redirect_uri=redirect_uri, scope=scope)
#     token = oauth.fetch_token(token_url, authorization_response=request.url, client_secret=client_secret)
#     access_token = token['access_token']
#     print('access token is:', access_token)


if __name__ == '__main__':
    print('Open this url in browser:', 'http://127.0.0.1:3000/positions/data', end='\n\n')

    app.run(host='127.0.0.1', port='3000')

    print('server stopped')

