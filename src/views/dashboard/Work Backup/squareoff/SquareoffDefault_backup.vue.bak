<template>
  <b-card no-body>
    <b-card-body class="pb-1">
      <b-card-title>
        <!-- <h1><span class="text-danger">Auto Squareoff</span> - <span class="text-success">Auto Takeprofit</span></h1> -->
        <h1>Set Auto Squareoff Parameters</h1>
      </b-card-title>
      <b-card-text>
        <strong>Please set your auto square off target or auto take profit target for all positions at once.</strong>
      </b-card-text>
      <div class="demo-spacing-0">
        <!-- primary -->
        <b-alert
          variant="warning"
          show
        >
          <h4 class="alert-heading">
            Warning !
          </h4>
          <div class="alert-body">
            <span>Auto Squareoff or Auto Takeprofits are execeuted at market prices and are subjected to market slippages. We do not take any responsibility of slippage losses due to auto squareoff of all positions in line with your set parameters.</span>
          </div>
        </b-alert>
      </div>
      <br>
      <br>
      <!-- <b-tabs pills nav-class="nav-pill-secondary"> -->
      <b-tabs>
        <b-tab active>
          <template #title>
            <feather-icon icon="TrendingUpIcon" />
            <h4><span class="text-primary">Basic</span></h4>
          </template>
          <div>
            <slider-input />
          </div>
        </b-tab>
        <b-tab>
          <template #title>
            <feather-icon icon="ZapIcon" />
            <h4><span class="text-primary">Advance</span></h4>
          </template>
          <br>
          <b-card-title>
            <h2 class="text-primary">
              Input The Minimum & Maximum Value (₹) At Which All Open Positions Shall Be Squaredoff.
            </h2>
          </b-card-title>
          <b-card-text>
            <strong class="text-dark">The Auto Squareoff will be set as " Squareoff All Positions if NetPNL ≥ Maximum 'or' NetPNL ≤ Minimum "</strong>
          </b-card-text>
          <br>
          <b-form
            novalidate
            class="needs-validation"
            @submit.prevent
          >
            <b-form-row>
              <!-- valid input  -->
              <b-col
                md="4"
                class="mb-3"
              >
                <h6><label for="input-invalid1"><strong>Select Net MTM / Net PNL</strong></label></h6>
                <b-form-group>
                  <v-select
                    v-model="selected"
                    :dir="$store.state.appConfig.isRTL ? 'rtl' : 'ltr'"
                    :options="sqroffif"
                    label="title"
                  >
                    <template #option="{ title, icon }">
                      <feather-icon
                        :icon="icon"
                        size="18"
                        class="align-middle mr-50"
                      />
                      <strong><span> {{ title }}</span></strong>
                    </template>
                  </v-select>
                </b-form-group>
              </b-col>
              <!-- invalid input -->
              <b-col
                md="4"
                class="mb-3"
              >
                <h6><label for="input-invalid1"><strong>Less Than or Equal To ( ≤ ) Value (₹)</strong></label></h6>
                <b-form-input
                  id="input-invalid1"
                  v-model="value1"
                  :state="value1 <= 0 && value1.length > 0"
                  placeholder="Invalid input"
                />
                <b-form-valid-feedback tooltip>
                  Looks Good!
                </b-form-valid-feedback>
                <b-form-invalid-feedback tooltip>
                  Please provide a valid input ≤ 0.
                </b-form-invalid-feedback>
              </b-col>
              <!-- invalid input -->
              <b-col
                md="4"
                class="mb-3"
              >
                <h6><label for="input-invalid2"><strong>Greater Than or Equal To ( ≥ ) Value (₹)</strong></label></h6>
                <b-form-input
                  id="input-invalid2"
                  v-model="value2"
                  :state="value2 >= 0 && value2.length > 0"
                  placeholder="Invalid input"
                />
                <b-form-valid-feedback tooltip>
                  Looks Good!
                </b-form-valid-feedback>
                <b-form-invalid-feedback tooltip>
                  Please provide a valid input ≥ 0.
                </b-form-invalid-feedback>
              </b-col>
              <br>
              <br>
              <!-- submit button -->
              <b-col cols="12">
                <b-button
                  v-ripple.400="'rgba(255, 255, 255, 0.15)'"
                  v-b-popover.hover.focus="'Please Recheck The Minimum & Maximum Values Once Again Before Clicking Submit, This Process is Irreversible !'"
                  block
                  title="Warning"
                  type="submit"
                  variant="relief-success"
                  @click="showToast('success')"
                >
                  Submit
                </b-button>
              </b-col>
            </b-form-row>
          </b-form>
        </b-tab>

        <b-tab>
          <template #title>
            <feather-icon icon="ZapIcon" />
            <h4><span class="text-primary">Advance-V1</span></h4>
          </template>
          <br>
          <b-card-title>
            <h2 class="text-primary">
              Input The Minimum & Maximum Value (₹) At Which All Open Positions Shall Be Squaredoff.
            </h2>
          </b-card-title>
          <b-card-text>
            <strong class="text-dark">The Auto Squareoff will be set as " Squareoff All Positions if NetPNL ≥ Maximum 'or' NetPNL ≤ Minimum "</strong>
          </b-card-text>
          <br>
          <b-form
            novalidate
            class="needs-validation"
            @submit.prevent
          >
            <b-form-row>
              <!-- valid input  -->
              <b-col
                md="4"
                class="mb-3"
              >
                <h6><label for="input-invalid1"><strong>Select Net MTM / Net PNL</strong></label></h6>
                <b-form-group>
                  <v-select
                    v-model="selected"
                    :dir="$store.state.appConfig.isRTL ? 'rtl' : 'ltr'"
                    :options="sqroffif"
                    label="title"
                  >
                    <template #option="{ title, icon }">
                      <feather-icon
                        :icon="icon"
                        size="18"
                        class="align-middle mr-50"
                      />
                      <strong><span> {{ title }}</span></strong>
                    </template>
                  </v-select>
                </b-form-group>
              </b-col>
              <b-col
                md="4"
                class="mb-3"
              >
                <div>
                  <h6><label for="sb-maxmin"><strong>Less Than or Equal To 0 ( ≤ 0 ) Value (₹)</strong></label></h6>
                  <b-form-spinbutton
                    id="sb-maxmin"
                    v-model="spinvalue_min"
                    min="-1000000"
                    max="0"
                    step="50"
                    :state="Boolean(spinvalue_min <= 0)"
                  />
                </div>
              </b-col>
              <b-col
                md="4"
                class="mb-3"
              >
                <div>
                  <h6><label for="sb-maxmin"><strong>Greater Than or Equal To 0 ( ≥ 0 ) Value (₹)</strong></label></h6>
                  <b-form-spinbutton
                    id="sb-maxmin"
                    v-model="spinvalue_max"
                    min="-0"
                    max="1000000"
                    step="50"
                    :state="Boolean(spinvalue_max >= 0)"
                  />
                </div>
              </b-col>
              <!-- submit button -->
              <!-- <b-col cols="12"> -->
              <b-col md="4">
                <b-button
                  v-ripple.400="'rgba(255, 255, 255, 0.15)'"
                  v-b-popover.hover.focus="'Please Recheck The Minimum & Maximum Values Once Again Before Clicking Submit, This Process is Irreversible !'"
                  block
                  title="Warning"
                  type="submit"
                  variant="relief-success"
                  @click="showToast('success')"
                >
                  Submit
                </b-button>
              </b-col>
              <b-col md="8">
                <b-alert
                  class="mb-0"
                  show
                  variant="success"
                >
                  <div class="alert-body">
                    <span>The </span>
                    <code>ArrowUp</code>
                    <span> and </span>
                    <code>ArrowDown</code>
                    <span> keys can be used to increment or decrement the value.</span>
                  </div>
                </b-alert>
              </b-col>
            </b-form-row>
          </b-form>
        </b-tab>

        <b-tab>
          <template #title>
            <feather-icon icon="ClockIcon" />
            <h4><span class="text-primary">Time</span></h4>
          </template>
          <br>
          <b-card-title>
            <h2 class="text-primary">
              Input The Exact Time At Which All Open Positions Shall Be Squaredoff.
            </h2>
          </b-card-title>
          <b-card-text>
            <strong class="text-dark">The Auto Squareoff will be set as Squareoff All Positions If Current Time = Set Time ( i.e. <span class="text-danger">{{ timevalue }}</span> )</strong>
          </b-card-text>
          <br>
          <div align="center">
            <b-time
              v-model="timevalue"
              show-seconds
              locale="en"
            >
              <div
                class="d-flex"
                dir="ltr"
              >
                <b-button
                  v-if="timevalue"
                  size="sm"
                  variant="outline-danger"
                  @click="clearTime"
                >
                  Clear time
                </b-button>
                <b-button
                  size="sm"
                  variant="outline-primary"
                  class="ml-auto"
                  @click="setNow"
                >
                  Set Now
                </b-button>
              </div>
            </b-time>
            <br>
            <br>
            <!-- submit button -->
            <b-col cols="12">
              <b-button
                v-ripple.400="'rgba(255, 255, 255, 0.15)'"
                v-b-popover.hover.focus="'Please Recheck The Desired Squareoff Time Again Before Clicking Submit, This Process is Irreversible !'"
                block
                title="Warning"
                type="submit"
                variant="relief-info"
                @click="showToast('success')"
              >
                Submit
              </b-button>
            </b-col>
          </div>
        </b-tab>
      </b-tabs>
    </b-card-body>
  </b-card>
</template>
<script>
import {
  BCard,
  BCardBody,
  BCardText,
  BCardTitle,
  // BTableSimple, BTr, BTbody, BTd,
  BAlert,
  BFormInput,
  BCol,
  BForm,
  BFormRow,
  BFormGroup,
  BFormValidFeedback,
  BFormInvalidFeedback,
  BButton,
  BTabs,
  BTab,
  VBPopover,
  BTime,
  BFormSpinbutton,
} from 'bootstrap-vue'
import Ripple from 'vue-ripple-directive'
import vSelect from 'vue-select'
import store from '@/store/index'
import ToastificationContent from '@core/components/toastification/ToastificationContent.vue'
import SliderInput from './SliderInput.vue'

export default {
  components: {
    BCard,
    BCardBody,
    BCardText,
    BCardTitle,
    BAlert,
    SliderInput,
    BForm,
    BFormInput,
    BButton,
    BFormRow,
    BFormValidFeedback,
    BFormInvalidFeedback,
    BCol,
    BFormGroup,
    vSelect,
    BTabs,
    BTab,
    BTime,
    // eslint-disable-next-line vue/no-unused-components
    ToastificationContent,
    BFormSpinbutton,
  },
  directives: {
    'b-popover': VBPopover,
    Ripple,
  },
  data() {
    return {
      selected: {
        title: 'If Net PNL is',
        icon: 'FileTextIcon',
      },
      value1: '-1000',
      value2: '1000',
      sqroffif: [{
        title: 'If Net MTM is',
        icon: 'TrendingUpIcon',
      },
      {
        title: 'If Net PNL is',
        icon: 'FileTextIcon',
      },
      ],
      timevalue: '15:20:22',
      spinvalue_min: '-50',
      spinvalue_max: '50',
    }
  },
  computed: {
    direction() {
      if (store.state.appConfig.isRTL) {
        // eslint-disable-next-line vue/no-side-effects-in-computed-properties
        this.dir = 'rtl'
        return this.dir
      }
      // eslint-disable-next-line vue/no-side-effects-in-computed-properties
      this.dir = 'ltr'
      return this.dir
    },
  },
  methods: {
    setNow() {
      const now = new Date()
      // Grab the HH:mm:ss part of the time string
      this.timevalue = now.toTimeString().slice(0, 8)
    },
    clearTime() {
      this.timevalue = ''
    },
    showToast(variant, timeout) {
      this.$toast({
        component: ToastificationContent,
        props: {
          title: 'Notification',
          icon: 'CheckIcon',
          text: 'Your Auto Squareoff Order Has Been Succesfully Placed',
          variant,
        },
      }, {
        timeout,
      })
    },
  },
}
</script>
